/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(w){var y="undefined"==typeof window?{}:window,t={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},n={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(a){return a instanceof
Array},isVal:function(a){a=typeof a;return"string"===a||"number"===a},isObj:function(a){return"object"===typeof a&&null!==a&&!n.isArr(a)},isFunc:function(a){return"function"===typeof a},isProm:function(a){return"object"===typeof a&&n.isFunc(a.then)},execAll:function(a,f){a&&(n.isArr(a)?a:[a]).forEach(function(a){return a.apply(null,f)})},insertArr:function(a,f,g,e){a.splice.apply(a,[g,e].concat(f))},isEvProp:function(a){return"on"===a.substr(0,2)},camelDash:function(a){return a.replace(/([a-z])([A-Z])/g,
"$1-$2").toLowerCase()},autoPx:function(a,f){return isNaN(f)||t[a]?f:f+"px"},indexOfKey:function(a,f,g,e){for(g=0;g<f.length;g++)if(f[g].key===a)return g;return-1},raft:function(a){function f(){g=0;a.apply(e,x)}if(!y.requestAnimationFrame)return a;var g,e,x;return function(){e=this;x=arguments;g||(g=y.requestAnimationFrame(f))}}};w.util=n})(domvm);(function(w){function y(b,c){return!1===c?null:null==c&&null!=b?b:m.isVal(c)?c:null}function t(b,c,z,v,d,k){function l(b,c,d){if(d)b[c]=b[c]||[],b[c].push(d);else for(var a in c)b[a]=b[a]||[],b[a].push(c[a])}function h(b,c,a){d=b;k=c;p.update(a,!1);return r(0,!1)}function r(b,v){if(b){for(var h=p;b--&&h.parent;)h=h.parent;h.redraw(0,!0);return h.vm}p.hooks&&m.execAll(p.hooks.willRedraw);p.refs={};var h=p.node,l=p.render.call(p.api,p,c,z),l=g(l,d,k,p);l.vm=p;p.node=l;var f=m.isVal(z)&&"^"===z[0]?z.substr(1):
m.isVal(l.ref)&&"^"===l.ref[0]?l.ref.substr(1):null;l.key=m.isVal(z)?z:l.key;for(var u=d;u;)u.vm&&(p.parent||(p.parent=u.vm),null!==f&&(u.vm.refs[f]=l)),u=u.parent;if((f=h)&&(l.type!==h.type||l.tag!==h.tag))var f=null,q=!0;e(l,f);d&&(d.body[k]=l);!1!==v&&(h&&a(h),!h&&E||x(l,null,l.el),q&&(h.el.parentNode.replaceChild(l.el,h.el),h.el=null));Promise.resolve().then(function(){p.hooks&&m.execAll(p.hooks.didRedraw)});return p}function f(b){p.hooks&&m.execAll(p.hooks.willUnmount);if(d)if(b){for(b=k+1;b<
d.body.length;b++){var c=d.body[b];c.idx=b-1;c.vm&&c.vm.updIdx(c.idx)}d.body.splice(k,1)}else d.body[k]=null;a(p.node,!0);p.node.vm=null;p.hooks&&m.execAll(p.hooks.didUnmount)}var E=!d;m.isArr(b)&&(c=b[1],z=b[2],v=b[3],b=b[0]);z=y(c,z);var p={api:{},node:null,view:[b,z],model:c,opts:v||{},render:null,update:function(b,d){null!=b&&z!==c&&(c=p.model=b);return!1!==d?r(0):p},on:function(b,c){l(p.events,b,c)},hook:function(b,c){p.hooks=p.hooks||{};l(p.hooks,b,c)},events:{},hooks:null,redraw:D.useRaf?m.raft(r):
r,patch:function(b,c){var d=b.parent,a=e(g(c,d,b.idx,p),b);d.body[b.idx]=a},emit:function(b){for(var c=Array.prototype.slice.call(arguments,1),d=p;d;){if(d.events[b]){m.execAll(d.events[b],c);break}d=d.parent}},refs:{},parent:null,mount:function(b,c){p.hooks&&m.execAll(p.hooks.willMount);c&&(b.textContent="");x(p.node,c?b:null);c||b.insertBefore(p.node.el,null);p.hooks&&m.execAll(p.hooks.didMount);return p},attach:function(b){n(p.node,b);return p},unmount:function(){A(p.hooks,"Unmount",f,[])},moveTo:h,
updIdx:function(b){k=b}};v&&v.hooks&&p.hook(v.hooks);m.execAll(C,[p]);p.render=b.call(p.api,p,c,z);return d?h(d,k):r(0)}function n(b,c){b.el=c;if(m.isArr(b.body))for(var a=0;a<b.body.length;a++)n(b.body[a],c.childNodes[a])}function a(b,c){m.isArr(b.body)&&(b.body.forEach(function(b,c){b&&(b.vm&&!b.moved?b.vm.unmount():a(b,!0))}),b.body=null);b.vm=null;c&&b.el&&b.el.parentNode&&A(b.hooks,"Remove",f,[b])}function f(b){b.el.parentNode.removeChild(b.el);b.el=null}function g(b,c,a,v){var d=b,k={type:null,
key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};m.isFunc(d)&&(d=d());if(m.isArr(d)&&d.length){k.type=m.TYPE_ELEM;if(1<d.length){var l=1;m.isObj(d[1])&&(k.props=d[1],l=2);k.body=d.length==l+1?m.isVal(d[l])?d[l]:m.isFunc(d[l])?d[l]():d.slice(l):d.slice(l)}d=d[0];if(/[.#]/.test(d)){if(d=L(d),k.tag=d.tag,d.id||d["class"])k.props=k.props||{},k.props.id=d.id,k.props["class"]=d["class"]}else k.tag=d;if(k.props){var d=k.props,
h;for(h in d)m.isEvProp(h)?d[h]=E(d[h],v.opts.evctx||v.model||null,k,v):m.isFunc(d[h])&&("href"==h?(d.onclick=d[h],d.href=d[h].path):d[h]=d[h]());if(m.isObj(d.style))for(var e in d.style)h=d.style[e],m.isFunc(h)&&(d.style[e]=h());m.isObj(d._hooks)&&(k.hooks=d._hooks,d._hooks=null);k.key=m.isVal(d._key)?d._key:m.isVal(d._ref)?d._ref:m.isVal(d.id)?d.id:m.isVal(d.name)?d.name:null;d._ref&&(k.ref=d._ref);d._raw&&(k.raw=!0);d._data&&(k.data=d._data);d._guard&&(k.guard=!0);d._ref=d._key=d._raw=d._data=
d._guard=null}}else m.isVal(d)&&(k.type=m.TYPE_TEXT,k.body=d);null!==k.ref&&(v.refs[k.ref]=k);k.parent=c;k.idx=a;k.ns=c&&c.ns?c.ns:"svg"===k.tag||"math"===k.tag?k.tag:null;if(m.isArr(k.body))for(c=0,a=k.body.length;c<a;c++){e=k.body[c];var d=h=null,x=l=!1;m.isFunc(e)&&(e=e());if(null==e)l=!0;else{var f=m.isArr(e),p=f?!1:m.isObj(e);if(f)e.length?m.isArr(e[0])?x=!0:m.isFunc(e[0])?h=y(b[1],b[2]):(d=g(e,k,c,v),h=d.key):l=!0;else if(p)if(m.isFunc(e.redraw))e.moveTo(k,c),d=e.node,h=e.view[1];else{k.body[c--]=
""+e;continue}else""===e?l=!0:0<c&&k.body[c-1].type===m.TYPE_TEXT?(k.body[c-1].body+=""+e,l=!0):d=g(""+e,k,c,v)}l||x?(x?m.insertArr(k.body,e,c,1):k.body.splice(c,1),a=k.body.length,c--):(null!==h&&(k.hasKeys=!0),k.body[c]=d||e)}return k}function e(b,c){c&&A(b.hooks,"Recycle",u,[c,b]);if(m.isArr(b.body)){var a=0;b.body.forEach(function(v,d){var k=m.isArr(v);if(c){var l=q(v,b,c,a);if(null!==l){var h=l[0],l=l[1];h===a&&a++;h=c.body[h];k&&h.vm?2===l?h.vm.moveTo(b,d,v[1]):1===l&&t(v[0],v[1],v[2],v[3],
b,d):b.body[d]=e(v,h);return}}k?t(v[0],v[1],v[2],v[3],b,d):b.body[d]=e(v)})}return b}function x(b,c,a){var e=!b.el;if(b.type==m.TYPE_ELEM)if(e&&(b.el=c&&c.nodeName?c:b.ns?F.createElementNS(M[b.ns],b.tag):F.createElement(b.tag),b.props&&I(b)),m.isArr(b.body)){c=0;for(var d=b.el.firstChild;c<b.body.length;c++)d=x(b.body[c],null,d)?d:d.nextSibling||null}else m.isVal(b.body)&&(b.raw?b.el.innerHTML=b.body:e&&(b.el.textContent=b.body));else b.type==m.TYPE_TEXT&&e&&(b.el=F.createTextNode(b.body));b.el._node=
b;if(a===b.el)return!1;if((c=b.parent)&&c.el)return A(b.hooks,e?"Insert":"Reinsert",r,[b,a]),!0}function r(b,c){b.parent.el.insertBefore(b.el,c)}function q(b,c,a,e,d){var k=m.isArr(b),l=k?b[2]||null:b.key,h=a.hasKeys,g=c.hasKeys;a=a.body;c=c.body;if(null!==l&&h&&(l=m.indexOfKey(l,a),-1<l))return[l,2];e=e||0;if(e>a.length-1)return null;d=0===d?0:d||a.length-1;for(l=null;e<=d;e++)if(h=a[e],null!==h&&h.el)if(k&&h.vm){if(h.vm.view[0]===b[0]){if(h.vm.view[1]===y(b[1],b[2]))return[e,2];var x=!1;if(D.viewScan)for(var f=
0;f<c.length;f++){var p=c[f];if(!p.el&&p.vm&&p.vm.view[0]===h.vm.view[0]&&p.vm.view[1]===h.vm.view[1]){x=!0;break}}x||l||!g||-1!=m.indexOfKey(h.key,c)||(l=[e,1])}}else if(b.type===h.type&&(b.type===m.TYPE_TEXT||null!==b.tag&&b.tag===h.tag)&&(null===h.key||!g||-1==m.indexOfKey(h.key,c)))return[e,1];return l}function u(b,c){c.el=b.el;b.el=null;if(c.type===m.TYPE_TEXT&&c.body!==b.body)c.el.nodeValue=c.body;else{I(c,b);var a=!m.isArr(c.body),e=!m.isArr(b.body);a&&c.body!==b.body?e&&c.el.firstChild?c.el.firstChild.nodeValue=
c.body:c.raw?c.el.innerHTML=c.body:c.el.textContent=c.body:e&&!a&&(c.el.textContent="");b.moved=!0}}function A(b,c,a,e,d,k){if(b){var l=b["will"+c];m.isArr(l)&&(l=l[0]);var h=b["did"+c];m.isArr(h)&&(h=h[0]);b=function(){a.apply(null,e);h&&h.apply(null,k||d||e)};l?(l=l.apply(null,d||e),m.isProm(l)?l.then(b):b()):b()}else a.apply(null,e)}function L(b){if(b in G)return G[b];var c={tag:null,id:null,"class":null};c.tag=b.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(b,a,d,e){d&&(c.id=
d);e&&(c["class"]=e.replace(/\./g," ").trim());return a||"div"});return G[b]=c}function E(b,c,a,e){return function(d){var k;if(m.isFunc(b))k=b.call(c,d,a,e);else if(m.isObj(b))for(var l in b)d.target.matches(l)&&(k=b[l].call(c,d,a,e));!1===k&&(d.preventDefault(),d.stopPropagation());e.opts.hasOwnProperty("watch")&&e.opts.watch.fire({vm:e})}}function I(b,c){var a=!c;c=c||{};if(c.props||b.props){var e=c.props||{},d=b.props||{},k=e.style,l=d.style;if(m.isObj(k)||m.isObj(l))J(b.el,k||{},l||{},H,B,b.ns,
a),e.style=d.style=null;J(b.el,e,d,N,K,b.ns,a);l&&(d.style=l)}}function J(b,c,a,e,d,k,l){for(var h in a)null!==a[h]&&(h in c&&a[h]===c[h]||e(b,h,a[h],k,l));for(h in c)null!==c[h]&&(h in a||d(b,h,k,l))}function H(b,c,a){b.style[c]=m.autoPx(c,a)}function B(b,c){b.style[c]=""}function N(b,c,a,e,d){"."===c[0]?(c=c.substr(1),"svg"===e?b[c].baseVal=a:b[c]=a):"class"===c?b.className=a:"id"===c||m.isEvProp(c)?b[c]=a:!1===a?K(b,c,e,d):(!0===a&&(a=""),b.setAttribute(c,a))}function K(b,c,a,e){e||("."===c[0]?
(c=c.substr(1),"svg"===a?b[c].baseVal=null:b[c]=null):"class"===c?b.className="":"id"===c||m.isEvProp(c)?b[c]=null:b.removeAttribute(c))}var M={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},G={},F="undefined"==typeof document?{}:document,D={useRaf:!0,viewScan:!1,useDOM:!1};w.view=t;w.view.config=function(b){D=b};var C=null;w.view.extend=function(b,c){C=!C||c?[]:C;C.push(b)};var m=w.util;return w})(domvm);(function(w){var y=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,t=w.util;w.html=function(n){var a="";switch(n.type){case t.TYPE_ELEM:a+="<"+n.tag;if(n.props){var f=t.isVal(n.props.style)?n.props.style:"",g=t.isObj(n.props.style)?n.props.style:null;if(g)for(var e in g)null!==g[e]&&(f+=t.camelDash(e)+": "+t.autoPx(e,g[e])+"; ");for(e in n.props)t.isEvProp(e)||(g=n.props[e],t.isFunc(g)&&(g=g()),t.isObj(g)||(!0===g?a+=" "+e:!1!==g&&null!==g&&"."!==e[0]&&
(a+=" "+e+'="'+g+'"')));f.length&&(a+=' style="'+f.trim()+'"')}if(n.ns&&"svg"!==n.tag&&"math"!==n.tag&&!n.body)return a+"/>";a+=">";break;case t.TYPE_TEXT:return n.body}y.test(n.tag)||(t.isArr(n.body)?n.body.forEach(function(e){a+=w.html(e)}):a+=n.body||"",a+="</"+n.tag+">");return a}})(domvm);(function(w){var y=w.util;w.watch=function(t){function n(){}function a(a,f,r,q,u){u=u||{};u.method=(u.method||a).toUpperCase();if(null!==r){var A=Object.prototype.toString.call(r);"[object Array]"===A||"[object Object]"===A?(u.headers=u.headers||new Headers,u.headers.set("Content-Type","application/json"),u.body=JSON.stringify(r)):u.body=""+r}var A=q,t=n;q instanceof Array&&(A=q[0],q[1]&&(t=q[1]));q=fetch(f,u).then(function(a){if(200<=a.status&&300>a.status)return a;var e=Error(a.status+": "+a.statusText);
e.data=a;return Promise.reject(e)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(A,t).then(function(a){!1!==a&&g.fire();return a},function(a){g.fire();return a});q._fetchArgs=[a,f,r,[A,t],u];return q}var f=[];y.isFunc(t)&&f.push(t);var g={on:function(a){f.push(a);return g},off:function(a){f.splice(f.indexOf(a),1);return g},fire:y.raft(function(){y.execAll(f,arguments);return g}),
prop:function(e,f){var r=e,q=function(a,e){arguments.length&&a!==r&&(r=a,!1!==e&&g.fire());return r};if(f&&f.then){q.update=n;if(f._fetchArgs){var u=f._fetchArgs[3];f._fetchArgs[3]=[function(a){return q(u[0]?u[0](a):a)},u[1]];q.update=function(){a.apply(null,f._fetchArgs)}}f.then(q)}return q.toString=q},sync:function(a,f,g){var q=a,u=f;"string"==typeof a&&(q=function(f){return"e."===a.substr(0,2)?f[a.substr(2)]:f.target[a]});return function(a){var e=this!==window?this:null;e&&"string"==typeof f&&
(u=function(a,g){var r=e[f];e[f]=a;t&&a!==r&&!1!==g&&t()});u(q(a),g)}},get:function(e,f,g){return a("get",e,null,f,g)},"delete":function(e,f,g){return a("delete",e,null,f,g)},post:function(e,f,g,q){return a("post",e,f,g,q)},put:function(e,f,g,q){return a("put",e,f,g,q)},patch:function(e,f,g,q){return a("patch",e,f,g,q)}};return g}})(domvm);(function(w){function y(a,f,g){if("/"===f[0]){var e=f;f=null;var n,r;for(r in a)if(n=e.match(a[r].regexPath)){g=n.slice(1);f=r;break}null===f&&(f="_noMatch")}else e=t(a,f,g);return{name:f,route:a[f],params:g,path:e}}function t(a,f,g){var e=a[f];a=e.path;if(g&&-1!==a.indexOf(":")){g=g.slice();var n=!0;a=a.replace(/:([^\/]+)/g,function(a,f){var u=g.shift();if(e.params&&e.params[f]){if((""+u).match(e.params[f]))return u;n=!1}else return u});return n?a:n}return a}function n(a){for(var f in a){var g=a[f];
g.regexPath=new RegExp("^"+g.path.replace(/:([^\/]+)/g,function(a,f){var n=""+g.params[f];return"("+n.substring(1,n.lastIndexOf("/"))+")"})+"$")}}w.route=function(a,f){var g={href:function(a,e,f){var n=function(n){g["goto"](a,e,f);n.preventDefault()};n.path=t(q,a,e);return n},refresh:function(){g["goto"](window.location.pathname)},"goto":function(a,f,g){f=f||[];g=g||e;var n=y(q,a,f),t=n.path;a=n.name;f=n.params;if(!1===t)console.log("Could not find route");else{for(var n=null,w=0;w<r.length;w++)if(r[w].path===
t){n=w;break}null===n&&(r.splice(x+1,1E4),r.push({name:a,route:q[a],params:f,path:t}),n=r.length-1);var w=r[x],H=r[n];Array.prototype.slice.call(arguments);var B=!0;null!==x&&(B=(B=r[x].route.onexit)?B.apply(null,[{to:H}].concat(w?w.params:[])):!0);!1!==B&&!1!==r[n].route.onenter.apply(null,[{from:w}].concat(f))&&(history[g?"replaceState":"pushState"]([a,f],"title",t),x=n);e=!1}},current:function(){return e?y(q,window.location.pathname):r[x]}},e=!0,x=null,r=[],q=a(g,f);n(q);window.onpopstate=function(a){g["goto"].apply(null,
a.state.concat(!0))};return g}})(domvm);
