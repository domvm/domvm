/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(w){var B="undefined"==typeof window?{}:window,t={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},a={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(d){return d instanceof
Array},isVal:function(d){d=typeof d;return"string"===d||"number"===d},isObj:function(d){return"object"===typeof d&&null!==d&&!a.isArr(d)},isFunc:function(d){return"function"===typeof d},isProm:function(d){return"object"===typeof d&&a.isFunc(d.then)},execAll:function(d,y){d&&(a.isArr(d)?d:[d]).forEach(function(d){return d.apply(null,y)})},insertArr:function(d,a,l,k){d.splice.apply(d,[l,k].concat(a))},isEvProp:function(d){return"on"===d.substr(0,2)},isDynProp:function(d,a){switch(d){case "input":case "textarea":case "select":case "option":switch(a){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},
camelDash:function(d){return d.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(d,a){return isNaN(a)||t[d]?a:a+"px"},indexOfKey:function(d,a,l,k){for(l=0;l<a.length;l++)if(a[l].key===d)return l;return-1},raft:function(d){function a(){l=0;d.apply(k,C)}if(!B.requestAnimationFrame)return d;var l,k,C;return function(){k=this;C=arguments;l||(l=B.requestAnimationFrame(a))}}};w.util=a})(domvm);(function(w){function B(b,c){return!1===c?null:null==c&&null!=b?b:f.isVal(c)||f.isObj(c)||f.isArr(c)||f.isFunc(c)?c:null}function t(b,c,z,m,e,p){function h(b,c,e){if(e)b[c]=b[c]||[],b[c].push(e);else for(var m in c)b[m]=b[m]||[],b[m].push(c[m])}function g(b,c,m){e=b;p=c;q.update(m,!1);return x(0,!1)}function x(b,m){if(b){for(var g=q;b--&&g.parent;)g=g.parent;g.redraw(0,!0);return g.vm}q.hooks&&f.execAll(q.hooks.willRedraw);q.refs={};var g=q.node,h=q.render.call(q.api,q,c,z),h=l(h,e,p,q);h.vm=q;q.node=
h;var a=f.isVal(z)&&"^"===z[0]?z.substr(1):f.isVal(h.ref)&&"^"===h.ref[0]?h.ref.substr(1):null;h.key=f.isVal(z)?z:h.key;for(var u=e;u;)u.vm&&(q.parent||(q.parent=u.vm),null!==a&&(u.vm.refs[a]=h)),u=u.parent;if((a=g)&&(h.type!==g.type||h.tag!==g.tag))var a=null,L=!0;k(h,a);e&&(e.body[p]=h);!1!==m&&(g&&d(g),!g&&n||C(h,null,h.el),L&&(g.el.parentNode.replaceChild(h.el,g.el),g.el=null));Promise.resolve().then(function(){q.hooks&&f.execAll(q.hooks.didRedraw)});return q}function u(b){q.hooks&&f.execAll(q.hooks.willUnmount);
if(e)if(b){for(b=p+1;b<e.body.length;b++){var c=e.body[b];c.idx=b-1;c.vm&&c.vm.updIdx(c.idx)}e.body.splice(p,1)}else e.body[p]=null;d(q.node,!0);q.node.vm=null;q.hooks&&f.execAll(q.hooks.didUnmount)}var n=!e;f.isArr(b)&&(c=b[1],z=b[2],m=b[3],b=b[0]);z=B(c,z);var q={api:{},node:null,view:[b,z],model:c,opts:m||{},render:null,update:function(b,e){null==b||z===c&&!f.isVal(z)||(c=q.model=b);return!1!==e?x(0):q},on:function(b,c){h(q.events,b,c)},hook:function(b,c){q.hooks=q.hooks||{};h(q.hooks,b,c)},events:{},
hooks:null,redraw:I.useRaf?f.raft(x):x,patch:function(b,c){var e=b.parent,m=k(l(c,e,b.idx,q),b);e.body[b.idx]=m},emit:function(b){for(var c=Array.prototype.slice.call(arguments,1),e=q;e;){if(e.events[b]){f.execAll(e.events[b],c);break}e=e.parent}},refs:{},parent:null,mount:function(b,c){c&&(b.textContent="");C(q.node,c?b:null);c||b.insertBefore(q.node.el,null);return q},attach:function(b){a(q.node,b);return q},unmount:function(){A(q.hooks,"Unmount",u,[])},moveTo:g,updIdx:function(b){p=b}};m&&m.hooks&&
q.hook(m.hooks);f.execAll(G,[q]);q.render=b.call(q.api,q,c,z);return e?g(e,p):x(0)}function a(b,c){b.el=c;c._node=b;for(var z in b.props){var m=b.props[z],e=f.isEvProp(z)?z:"."===z[0]?z.substr(1):null;null!==e&&(c[e]=m)}if(f.isArr(b.body))for(z=0;z<b.body.length;z++)a(b.body[z],c.childNodes[z])}function d(b,c){f.isArr(b.body)&&(b.body.forEach(function(b,c){b&&(b.vm&&!b.moved?b.vm.unmount():d(b,!0))}),b.body=null);b.vm=null;c&&b.el&&b.el.parentNode&&A(b.hooks,"Remove",y,[b])}function y(b){b.el.parentNode.removeChild(b.el);
b.el=null}function l(b,c,d,m){var e=b,p={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};f.isFunc(e)&&(e=e());if(f.isArr(e)&&e.length){p.type=f.TYPE_ELEM;if(1<e.length){var h=1;f.isObj(e[1])&&(p.props=e[1],h=2);p.body=e.length==h+1?f.isVal(e[h])?e[h]:f.isFunc(e[h])?e[h]():e.slice(h):e.slice(h)}e=e[0];if(/[.#]/.test(e)){if(e=D(e),p.tag=e.tag,e.id||e["class"])p.props=p.props||{},p.props.id=e.id,p.props["class"]=
e["class"]}else p.tag=e;if(p.props){var e=p.props,g;for(g in e)f.isEvProp(g)?e[g]=x(e[g],m.opts.evctx||m.model||null,p,m):f.isFunc(e[g])&&("href"==g?(e.onclick=e[g],e.href=e[g].href):e[g]=e[g]()),f.isDynProp(p.tag,g)&&(e["."+g]=e[g]);if(f.isObj(e.style))for(var a in e.style)g=e.style[a],f.isFunc(g)&&(e.style[a]=g());f.isObj(e._hooks)&&(p.hooks=e._hooks,e._hooks=null);p.key=f.isVal(e._key)?e._key:f.isVal(e._ref)?e._ref:f.isVal(e.id)?e.id:f.isVal(e.name)?e.name:null;e._ref&&(p.ref=e._ref);e._raw&&(p.raw=
!0);e._data&&(p.data=e._data);e._guard&&(p.guard=!0);e._ref=e._key=e._raw=e._data=e._guard=null}}else f.isVal(e)&&(p.type=f.TYPE_TEXT,p.body=e);null!==p.ref&&(m.refs[p.ref]=p);p.parent=c;p.idx=d;p.ns=c&&c.ns?c.ns:"svg"===p.tag||"math"===p.tag?p.tag:null;if(f.isArr(p.body))for(c=0,d=p.body.length;c<d;c++){a=p.body[c];var e=g=null,k=h=!1;f.isFunc(a)&&(a=a());if(null==a)h=!0;else{var u=f.isArr(a),q=u?!1:f.isObj(a);if(u)a.length?f.isArr(a[0])?k=!0:f.isFunc(a[0])?g=B(b[1],b[2]):(e=l(a,p,c,m),g=e.key):
h=!0;else if(q)if(f.isFunc(a.redraw))a.moveTo(p,c),e=a.node,g=a.view[1];else{p.body[c--]=""+a;continue}else""===a?h=!0:0<c&&p.body[c-1].type===f.TYPE_TEXT?(p.body[c-1].body+=""+a,h=!0):e=l(""+a,p,c,m)}h||k?(k?f.insertArr(p.body,a,c,1):p.body.splice(c,1),d=p.body.length,c--):(null!==g&&(p.hasKeys=!0),p.body[c]=e||a)}return p}function k(b,c){c&&A(b.hooks,"Recycle",r,[c,b]);if(f.isArr(b.body)){var a=0;b.body.forEach(function(m,e){var d=f.isArr(m);if(c){var h=n(m,b,c,a);if(null!==h){var g=h[0],h=h[1];
g===a&&a++;g=c.body[g];d&&g.vm?2===h?g.vm.moveTo(b,e,m[1]):1===h&&t(m[0],m[1],m[2],m[3],b,e):b.body[e]=k(m,g);return}}d?t(m[0],m[1],m[2],m[3],b,e):b.body[e]=k(m)})}return b}function C(b,c,a){var m=!b.el;m&&b.vm&&b.vm.hooks&&f.execAll(b.vm.hooks.willMount);if(b.type==f.TYPE_ELEM)if(m&&(b.el=c&&c.nodeName?c:b.ns?J.createElementNS(E[b.ns],b.tag):J.createElement(b.tag),b.props&&u(b)),f.isArr(b.body)){c=0;for(var e=b.el.firstChild;c<b.body.length;c++)e=C(b.body[c],null,e)?e:e.nextSibling||null}else f.isVal(b.body)&&
(b.raw?b.el.innerHTML=b.body:m&&(b.el.textContent=b.body));else b.type==f.TYPE_TEXT&&m&&(b.el=J.createTextNode(b.body));c=!0;b.el._node=b;a===b.el&&(c=!1);e=b.parent;c&&e&&e.el&&(A(b.hooks,m?"Insert":"Reinsert",v,[b,a]),c=!0);m&&b.vm&&b.vm.hooks&&f.execAll(b.vm.hooks.didMount);return c}function v(b,c){b.parent.el.insertBefore(b.el,c)}function n(b,c,a,m,e){var d=f.isArr(b),h=d?b[2]||null:b.key,g=a.hasKeys,k=c.hasKeys;a=a.body;c=c.body;if(null!==h&&g&&(h=f.indexOfKey(h,a),-1<h))return[h,2];m=m||0;if(m>
a.length-1)return null;e=0===e?0:e||a.length-1;for(h=null;m<=e;m++)if(g=a[m],null!==g&&g.el)if(d&&g.vm){if(g.vm.view[0]===b[0]){if(g.vm.view[1]===B(b[1],b[2]))return[m,2];var u=!1;if(I.viewScan)for(var x=0;x<c.length;x++){var q=c[x];if(!q.el&&q.vm&&q.vm.view[0]===g.vm.view[0]&&q.vm.view[1]===g.vm.view[1]){u=!0;break}}u||h||!k||-1!=f.indexOfKey(g.key,c)||(h=[m,1])}}else if(b.type===g.type&&(b.type===f.TYPE_TEXT||null!==b.tag&&b.tag===g.tag)&&(null===g.key||!k||-1==f.indexOfKey(g.key,c)))return[m,1];
return h}function r(b,c){c.el=b.el;b.el=null;if(c.type===f.TYPE_TEXT&&c.body!==b.body)c.el.nodeValue=c.body;else{u(c,b);var a=!f.isArr(c.body),m=!f.isArr(b.body);a&&c.body!==b.body?m&&c.el.firstChild?c.el.firstChild.nodeValue=c.body:c.raw?c.el.innerHTML=c.body:c.el.textContent=c.body:m&&!a&&(c.el.textContent="");b.moved=!0}}function A(b,c,a,m,e,d){if(b){var h=b["will"+c];f.isArr(h)&&(h=h[0]);var g=b["did"+c];f.isArr(g)&&(g=g[0]);b=function(){a.apply(null,m);g&&g.apply(null,d||e||m)};h?(h=h.apply(null,
e||m),f.isProm(h)?h.then(b):b()):b()}else a.apply(null,m)}function D(b){if(b in K)return K[b];var c={tag:null,id:null,"class":null};c.tag=b.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(b,a,e,d){e&&(c.id=e);d&&(c["class"]=d.replace(/\./g," ").trim());return a||"div"});return K[b]=c}function x(b,c,a,d){return function(e){var a,h=e.target._node,g=null;if(f.isFunc(b))a=b.call(c,e,h,d);else if(f.isArr(b))g=b.slice(1),a=b[0].apply(c,g.concat(e,h,d));else if(f.isObj(b))for(var k in b){var u=
b[k];e.target.matches(k)&&(f.isArr(u)?(g=u.slice(1),a=u[0].apply(c,g.concat(e,h,d))):f.isFunc(u)&&(a=u.call(c,e,h,d)))}!1===a&&(e.preventDefault(),e.stopPropagation());d.opts.hasOwnProperty("watch")&&d.opts.watch.fire({type:"event",vm:d,node:h,event:e,data:g})}}function u(b,c){var a=!c;c=c||{};if(c.props||b.props){var d=c.props||{},e=b.props||{},k=d.style,h=e.style;if(f.isObj(k)||f.isObj(h))F(b.el,b.tag,k||{},h||{},M,N,b.ns,a),d.style=e.style=null;F(b.el,b.tag,d,e,O,H,b.ns,a);h&&(e.style=h)}}function F(b,
c,a,d,e,f,h,g){for(var k in d)null!==d[k]&&("."===k[0]?b[k.substr(1)]!==d[k]:d[k]!==a[k])&&e(b,k,d[k],h,g);for(k in a)null!==a[k]&&null==d[k]&&f(b,k,h,g)}function M(b,c,a){b.style[c]=f.autoPx(c,a)}function N(b,c){b.style[c]=""}function O(b,c,a,d,e){"."===c[0]?(c=c.substr(1),"svg"===d?b[c].baseVal=a:b[c]=a):"class"===c?b.className=a:"id"===c||f.isEvProp(c)?b[c]=a:!1===a?H(b,c,d,e):b.setAttribute(c,!0===a?"":a)}function H(b,c,a,d){d||("."===c[0]?(c=c.substr(1),"svg"===a?b[c].baseVal=null:b[c]=null):
"class"===c?b.className="":"id"===c||f.isEvProp(c)?b[c]=null:b.removeAttribute(c))}var E={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},K={},J="undefined"==typeof document?{}:document,I={useRaf:!0,viewScan:!1,useDOM:!1};w.view=t;w.view.config=function(b){I=b};var G=null;w.view.extend=function(b,c){G=!G||c?[]:G;G.push(b)};var f=w.util;return w})(domvm);(function(w){var B=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,t=w.util;w.html=function(a){var d="";switch(a.type){case t.TYPE_ELEM:d+="<"+a.tag;if(a.props){var y=t.isVal(a.props.style)?a.props.style:"",l=t.isObj(a.props.style)?a.props.style:null;if(l)for(var k in l)null!==l[k]&&(y+=t.camelDash(k)+": "+t.autoPx(k,l[k])+"; ");for(k in a.props)t.isEvProp(k)||"."===k[0]||(l=a.props[k],t.isFunc(l)&&(l=l()),t.isObj(l)||(!0===l?d+=" "+k:!1!==l&&null!==l&&
"."!==k[0]&&(d+=" "+k+'="'+l+'"')));y.length&&(d+=' style="'+y.trim()+'"')}if(a.ns&&"svg"!==a.tag&&"math"!==a.tag&&!a.body)return d+"/>";d+=">";break;case t.TYPE_TEXT:return a.body}B.test(a.tag)||(t.isArr(a.body)?a.body.forEach(function(a){d+=w.html(a)}):d+=a.body||"",d+="</"+a.tag+">");return d}})(domvm);(function(w){var B=w.util;w.watch=function(t){function a(){}function d(d,C,v,n,r){r=r||{};r.method=(r.method||d).toUpperCase();if(null!==v){var A=Object.prototype.toString.call(v);"[object Array]"===A||"[object Object]"===A?(r.headers=r.headers||new Headers,r.headers.set("Content-Type","application/json"),r.body=JSON.stringify(v)):r.body=""+v}var A=n,D=a;n instanceof Array&&(A=n[0],n[1]&&(D=n[1]));var x={type:"fetch",fetch:{method:d,url:C,body:v}};n=fetch(C,r).then(function(a){if(200<=a.status&&300>
a.status)return a;var d=Error(a.status+": "+a.statusText);d.data=a;return Promise.reject(d)}).then(function(a){switch(a.headers.get("Content-Type").split("; ")[0]){case "application/json":return a.json();case "text/plain":return a.text();default:return a}}).then(A,D).then(function(a){!1!==a&&l.fire(x);return a},function(a){x.error=a;l.fire(x);return a});n._fetchArgs=[d,C,v,[A,D],r];return n}var y=[];B.isFunc(t)&&y.push(t);var l={on:function(a){y.push(a);return l},off:function(a){y.splice(y.indexOf(a),
1);return l},fire:B.raft(function(){B.execAll(y,arguments);return l}),prop:function(k,C){var v=k,n=function(a,d){if(arguments.length&&a!==v){var k=v;v=a;!1!==d&&l.fire({type:"prop",prop:n,data:{old:k,"new":a}})}return v};if(C&&C.then){n.update=a;if(C._fetchArgs){var r=C._fetchArgs[3];C._fetchArgs[3]=[function(a){return n(r[0]?r[0](a):a)},r[1]];n.update=function(){d.apply(null,C._fetchArgs)}}C.then(n)}return n.toString=n},sync:function(a,d,l){var n=a,r=d;"string"==typeof a&&(n=function(d){return"e."===
a.substr(0,2)?d[a.substr(2)]:d.target[a]});return function(a,k){var x=this!==window?this:null;x&&"string"==typeof d&&(r=function(a,k){var l=x[d];x[d]=a;t&&a!==l&&!1!==k&&t()});r(n(k),l)}},get:function(a,l,v){return d("get",a,null,l,v)},"delete":function(a,l,v){return d("delete",a,null,l,v)},post:function(a,l,v,n){return d("post",a,l,v,n)},put:function(a,l,v,n){return d("put",a,l,v,n)},patch:function(a,l,v,n){return d("patch",a,l,v,n)}};return l}})(domvm);(function(w){function B(a,d,l,n,r,A){var t=null,x=null,u=null;if("/"==l[0]){u=l;x=!1;n={};A=u.split("#");d=A[0].split("?");t=d[0];A=A[1];d[1]&&(r={},d[1].split("&").map(function(a){a=a.split("=");r[a[0]]=null==a[1]?!0:a[1]}));var F,y;for(y in a){l=a[y];var w=l.path;if(F=t.match(l.regexPath)){x=y;-1!==w.indexOf(":")&&(n={},F.shift(),w.replace(/:([^\/]+)/g,function(a,d){n[d]=F.shift()}));break}}}else{x=l;l=a[x];var w=d+l.path,B=l.vars||{},H=/^[^\/]+$/,u=-1!==w.indexOf(":")?t=w.replace(/:([^\/]+)/g,
function(a,d){if((B[d]||H).test(n[d]))return n[d]+="";throw Error("Invalid value for route '"+w+"' segment '"+d+"': '"+n[d]+"'");}):t=w;if(r){var u=u+"?",E;for(E in r)u+=E+(!0!==r[E]?"="+r[E]:"")+"&";u=u.slice(0,-1)}u+=A?"#"+A:""}return{href:u,name:x,path:t,segs:n,hash:A,query:r}}function t(a,d){for(var l in a){var n=a[l];n.regexPath=new RegExp("^"+d+n.path.replace(/:([^\/]+)/g,function(a,d){var l=""+n.vars[d];return"("+l.substring(1,l.lastIndexOf("/"))+")"})+"$")}}var a=[],d=null,y=!1,l="";w.route=
function(k,w){function v(){var a=location,a=y?a.href.substr(a.origin.length):a.hash.substr(1)||"/";return B(D,l,a)}var n=null,r={href:function(a,d,k,n,t){var v=B(D,l,a,d,k,n);return y?(a=function(a){r["goto"](v,null,null,null,t);a.preventDefault()},a.href=v.href,a):"#"+v.href},config:function(a){(y=a.useHist)&&(l=a.root||"");n=a.init||null},refresh:function(){r["goto"](v(),null,null,null,!0)},"goto":function(k,n,r,t,v){v=v||A;k.href||(k=B(D,l,k,n,r,t));if(!1===k.name)console.log("Could not find route");
else{n=null;for(r=0;r<a.length;r++)if(a[r].path===k.path){n=r;break}null===n&&(a.splice(d+1,1E4),a.push(k),n=a.length-1);k=a[d];r=a[n];t=!0;null!==d&&(t=(t=D[k.name].onexit)?t.apply(null,(k?[k.segs,k.query,k.hash]:[]).concat(r)):!0);if(!1!==t&&!1!==D[r.name].onenter.apply(null,(r?[r.segs,r.query,r.hash]:[]).concat(k))){if(y)history[v?"replaceState":"pushState"](null,"title",r.href);d=n}A=!1}},location:function(){return A?v():a[d]}},A=!0,D=k(r,w);t(D,l);window.onhashchange=window.onpopstate=function(a){(y||
"popstate"!=a.type)&&r["goto"](v(),null,null,null,!0)};n&&n();return r}})(domvm);
