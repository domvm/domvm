/*
 https://github.com/leeoniya/domvm
*/
("undefined"!==typeof global?global:this).domvm={};(function(u){var w="undefined"==typeof window?{}:window,t={TYPE_ELEM:1,TYPE_TEXT:2,isArr:function(d){return d instanceof Array},isVal:function(d){d=typeof d;return"string"===d||"number"===d},isObj:function(d){return"object"===typeof d&&null!==d&&!t.isArr(d)},isFunc:function(d){return"function"===typeof d},isProm:function(d){return"object"===typeof d&&t.isFunc(d.then)},execAll:function(d,b){d&&(t.isArr(d)?d:[d]).forEach(function(d){return d.apply(null,b)})},insertArr:function(d,b,l,g){d.splice.apply(d,
[l,g].concat(b))},isEvProp:function(d){return"on"===d.substr(0,2)},camelDash:function(d){return d.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},raft:function(d){function b(){l=0;d.apply(g,h)}if(!w.requestAnimationFrame)return d;var l,g,h;return function(){g=this;h=arguments;l||(l=w.requestAnimationFrame(b))}}};u.util=t})(domvm);(function(u){function w(a,e,v,n,c,b,y){function k(a,c,e){if(e)a[c]=a[c]||[],a[c].push(e);else for(var n in c)a[n]=a[n]||[],a[n].push(c[n])}function f(a,c,e){b=a;y=c;return q(0,e,!1)}function q(a,c,k){if(a){for(k=p;a--&&k.parent;)k=k.parent;k.redraw(0,c,!0);return k.vm}p.hooks&&m.execAll(p.hooks.willRedraw);p.imp=null!=c?c:n;p.refs={};a=p.node;c=p.render.call(p.exp,p,e,v,p.imp);c=l(c,b,y,p);c.key=m.isVal(v)?v:c.key;c.vm=p;p.node=c;for(var f="^"===(""+c.key)[0]?c.key.substr(1):null,r=b;r;)r.vm&&(p.parent||
(p.parent=r.vm),null!==f&&(r.vm.refs[f]=c)),r=r.parent;if((f=a)&&(c.type!==a.type||c.tag!==a.tag))var f=null,A=!0;g(c,f);b&&(b.body[y]=c);!1!==k&&(a&&d(a),!a&&E||h(c,null,c.el),A&&(a.el.parentNode.replaceChild(c.el,a.el),a.el=null));Promise.resolve().then(function(){p.hooks&&m.execAll(p.hooks.didRedraw)});return p}function A(a){p.hooks&&m.execAll(p.hooks.willUnmount);if(b)if(a){for(a=y+1;a<b.body.length;a++){var c=b.body[a];c.idx=a-1;c.vm&&c.vm.updIdx(c.idx)}b.body.splice(y,1)}else b.body[y]=null;
d(p.node,!0);p.node.vm=null;p.hooks&&m.execAll(p.hooks.didUnmount)}var E=!b;m.isArr(a)&&(e=a[1],v=a[2],n=a[3],c=a[4],a=a[0]);!1===v&&(n=e,v=e=null);var p={exp:{},imp:n||{},node:null,view:[a,e,v],opts:c||{},render:null,on:function(a,c){k(p.events,a,c)},hook:function(a,c){p.hooks=p.hooks||{};k(p.hooks,a,c)},events:{},hooks:null,redraw:D.useRaf?m.raft(q):q,patch:function(a,c){var e=a.parent,n=g(l(c,e,a.idx,p),a);e.body[a.idx]=n;n=n.key;m.isVal(n)&&(e.keyMap[n]=a.idx)},emit:function(a){for(var c=Array.prototype.slice.call(arguments,
1),e=p;e;){if(e.events[a]){m.execAll(e.events[a],c);break}e=e.parent}},refs:{},parent:null,mount:function(a,c){p.hooks&&m.execAll(p.hooks.willMount);c&&(a.textContent="");h(p.node,c?a:null);c||a.insertBefore(p.node.el,null);p.hooks&&m.execAll(p.hooks.didMount);return p},attach:function(a){t(p.node,a);return p},unmount:function(){r(p.hooks,"Unmount",A,[])},moveTo:f,updIdx:function(a){y=a}};c&&c.hooks&&p.hook(c.hooks);m.execAll(C,[p]);p.render=a.call(p.exp,p,e,v,n);return b?f(b,y,n):q(0,n)}function t(a,
e){a.el=e;if(m.isArr(a.body))for(var v=0;v<a.body.length;v++)t(a.body[v],e.childNodes[v])}function d(a,e){m.isArr(a.body)&&(a.body.forEach(function(a,e){a&&(a.vm&&!a.moved?a.vm.unmount():d(a,!0))}),a.body=null);a.vm=null;e&&a.el&&a.el.parentNode&&r(a.hooks,"Remove",b,[a])}function b(a){a.el.parentNode.removeChild(a.el);a.el=null}function l(a,e,v,n){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,hooks:null,tag:null,ns:null,guard:!1,raw:!1,props:null,el:null,keyMap:null,body:null};
m.isFunc(c)&&(c=c());if(m.isArr(c)&&c.length){a.type=m.TYPE_ELEM;if(1<c.length){var b=1;m.isObj(c[1])&&(a.props=c[1],b=2);a.body=c.length==b+1?m.isVal(c[b])?c[b]:m.isFunc(c[b])?c[b]():c.slice(b):c.slice(b)}c=c[0];if(/[.#]/.test(c)){if(c=z(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=c;if(a.props){var c=a.props,d;for(d in c)m.isEvProp(d)?c[d]=K(c[d],n.opts.evctx||n.view[1]||n.imp||null,a,n):m.isFunc(c[d])&&("href"==d?(c.onclick=c[d],c.href=
c[d].path):c[d]=c[d]());if(m.isObj(c.style))for(var k in c.style)d=c.style[k],m.isFunc(d)&&(c.style[k]=d());m.isObj(c._hooks)&&(a.hooks=c._hooks,c._hooks=null);a.key=m.isVal(c._key)?c._key:m.isVal(c._ref)?c._ref:m.isVal(c.id)?c.id:m.isVal(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);c._data&&(a.data=c._data);c._guard&&(a.guard=!0);c._ref=c._key=c._raw=c._data=c._guard=null}}else m.isVal(c)&&(a.type=m.TYPE_TEXT,a.body=c);null!==a.ref&&(n.refs[a.ref]=a);a.parent=e;a.idx=v;a.ns=e&&e.ns?
e.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(m.isArr(a.body)){e={};v=!1;k=0;for(d=a.body.length;k<d;k++){var c=a.body[k],h=b=null,f=!1,g=!1;m.isFunc(c)&&(c=c());if(null==c)f=!0;else{var q=m.isArr(c),p=q?!1:m.isObj(c);if(q)c.length?m.isArr(c[0])?g=!0:m.isFunc(c[0])?b=c[2]:(h=l(c,a,k,n),b=h.key):f=!0;else if(p)if(m.isFunc(c.redraw))c.moveTo(a,k),h=c.node,b=c.view[2];else{a.body[k--]=""+c;continue}else""===c?f=!0:0<k&&a.body[k-1].type===m.TYPE_TEXT?(a.body[k-1].body+=""+c,f=!0):h=l(""+c,a,k,n)}f||
g?(g?m.insertArr(a.body,c,k,1):a.body.splice(k,1),d=a.body.length,k--):(m.isVal(b)&&(e[b]=k,v=!0),a.body[k]=h||c)}v&&(a.keyMap=e)}return a}function g(a,e){e&&r(a.hooks,"Recycle",E,[e,a]);if(m.isArr(a.body)){var b=0;a.body.forEach(function(n,c){var d=m.isArr(n);if(e){var h=q(n,a,e,b);if(null!==h){var k=h[0],h=h[1];k===b&&b++;k=e.body[k];d&&k.vm?2===h?k.vm.moveTo(a,c,n[3]):1===h&&w(n[0],n[1],n[2],n[3],n[4],a,c):a.body[c]=g(n,k);return}}d?w(n[0],n[1],n[2],n[3],n[4],a,c):a.body[c]=g(n)})}return a}function h(a,
e,b){var n=!a.el;if(a.type==m.TYPE_ELEM)if(n&&(a.el=e&&e.nodeName?e:a.ns?F.createElementNS(L[a.ns],a.tag):F.createElement(a.tag),a.props&&A(a)),m.isArr(a.body)){e=0;for(var c=a.el.firstChild;e<a.body.length;e++)c=h(a.body[e],null,c)?c:c.nextSibling||null}else m.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:n&&(a.el.textContent=a.body));else a.type==m.TYPE_TEXT&&n&&(a.el=F.createTextNode(a.body));a.el._node=a;if(b===a.el)return!1;if((e=a.parent)&&e.el)return r(a.hooks,n?"Insert":"Reinsert",f,[a,b]),
!0}function f(a,e){a.parent.el.insertBefore(a.el,e)}function q(a,e,b,n,c){var d=m.isArr(a),h=d?a[2]||null:a.key,k=b.keyMap,f=e.keyMap;b=b.body;e=e.body;if(null!==h&&k&&m.isVal(k[h]))return[k[h],2];n=n||0;if(n>b.length-1)return null;c=0===c?0:c||b.length-1;for(h=null;n<=c;n++)if(k=b[n],null!==k&&k.el)if(d&&k.vm){if(k.vm.view[0]===a[0]){if(k.vm.view[1]===a[1])return[n,2];var g=!1;if(D.viewScan)for(var q=0;q<e.length;q++){var r=e[q];if(!r.el&&r.vm&&r.vm.view[0]===k.vm.view[0]&&r.vm.view[1]===k.vm.view[1]){g=
!0;break}}g||h||!f||m.isVal(f[k.key])||(h=[n,1])}}else if(!(a.type!==k.type||a.type!==m.TYPE_TEXT&&(null===a.tag||a.tag!==k.tag)||null!==k.key&&f&&m.isVal(f[k.key])))return[n,1];return h}function E(a,e){e.el=a.el;a.el=null;if(e.type===m.TYPE_TEXT&&e.body!==a.body)e.el.nodeValue=e.body;else{A(e,a);var b=!m.isArr(e.body),d=!m.isArr(a.body);b&&e.body!==a.body?d&&e.el.firstChild?e.el.firstChild.nodeValue=e.body:e.raw?e.el.innerHTML=e.body:e.el.textContent=e.body:d&&!b&&(e.el.textContent="");a.moved=!0}}
function r(a,e,b,d,c,h){if(a){var f=a["will"+e];m.isArr(f)&&(f=f[0]);var k=a["did"+e];m.isArr(k)&&(k=k[0]);a=function(){b.apply(null,d);k&&k.apply(null,h||c||d)};f?(f=f.apply(null,c||d),m.isProm(f)?f.then(a):a()):a()}else b.apply(null,d)}function z(a){if(a in G)return G[a];var e={tag:null,id:null,"class":null};e.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,b,c,d){c&&(e.id=c);d&&(e["class"]=d.replace(/\./g," ").trim());return b||"div"});return G[a]=e}function K(a,e,b,d){return function(c){var h;
if(m.isFunc(a))h=a.call(e,c,b,d);else if(m.isObj(a))for(var f in a)c.target.matches(f)&&(h=a[f].call(e,c,b,d));!1===h&&(c.preventDefault(),c.stopPropagation());d.opts.hasOwnProperty("watch")&&d.opts.watch.fire({vm:d})}}function A(a,e){var b=!e;e=e||{};if(e.props||a.props){var d=e.props||{},c=a.props||{},h=d.style,f=c.style;if(m.isObj(h)||m.isObj(f))I(a.el,h||{},f||{},x,H,a.ns,b),d.style=c.style=null;I(a.el,d,c,B,J,a.ns,b);f&&(c.style=f)}}function I(a,e,b,d,c,h,f){for(var k in b)null!==b[k]&&(k in
e&&b[k]===e[k]||d(a,k,b[k],h,f));for(k in e)null!==e[k]&&(k in b||c(a,k,h,f))}function x(a,e,b){a.style[e]=isNaN(b)||M[e]?b:b+"px"}function H(a,e){a.style[e]=""}function B(a,e,b,d,c){"."===e[0]?(e=e.substr(1),"svg"===d?a[e].baseVal=b:a[e]=b):"class"===e?a.className=b:"id"===e||m.isEvProp(e)?a[e]=b:!1===b?J(a,e,d,c):(!0===b&&(b=""),a.setAttribute(e,b))}function J(a,e,b,d){d||("."===e[0]?(e=e.substr(1),"svg"===b?a[e].baseVal=null:a[e]=null):"class"===e?a.className="":"id"===e||m.isEvProp(e)?a[e]=null:
a.removeAttribute(e))}var L={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},G={},F="undefined"==typeof document?{}:document,M={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,
transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},D={useRaf:!0,viewScan:!1,useDOM:!1};u.view=w;u.view.config=function(a){D=a};var C=null;u.view.extend=function(a,b){C=!C||b?[]:C;C.push(a)};var m=u.util;return u})(domvm);(function(u){var w=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,t=u.util;u.html=function(d){var b="";switch(d.type){case t.TYPE_ELEM:b+="<"+d.tag;if(d.props){var l=t.isVal(d.props.style)?d.props.style:"",g=t.isObj(d.props.style)?d.props.style:null;if(g)for(var h in g)null!==g[h]&&(l+=t.camelDash(h)+": "+g[h]+";");for(h in d.props)t.isEvProp(h)||(g=d.props[h],t.isFunc(g)&&(g=g()),t.isObj(g)||(!0===g?b+=" "+h:!1!==g&&null!==g&&"."!==h[0]&&(b+=" "+h+'="'+
g+'"')));l.length&&(b+=' style="'+l+'"')}if(d.ns&&"svg"!==d.tag&&"math"!==d.tag&&!d.body)return b+"/>";b+=">";break;case t.TYPE_TEXT:return d.body}w.test(d.tag)||(t.isArr(d.body)?d.body.forEach(function(d){b+=u.html(d)}):b+=d.body||"",b+="</"+d.tag+">");return b}})(domvm);(function(u){var w=u.util;u.watch=function(t){function d(){}function b(b,f,q,l,r){r=r||{};r.method=(r.method||b).toUpperCase();if(null!==q){var z=Object.prototype.toString.call(q);"[object Array]"===z||"[object Object]"===z?(r.headers=r.headers||new Headers,r.headers.set("Content-Type","application/json"),r.body=JSON.stringify(q)):r.body=""+q}var z=l,t=d;l instanceof Array&&(z=l[0],l[1]&&(t=l[1]));l=fetch(f,r).then(function(b){if(200<=b.status&&300>b.status)return b;var d=Error(b.status+": "+b.statusText);
d.data=b;return Promise.reject(d)}).then(function(b){switch(b.headers.get("Content-Type").split("; ")[0]){case "application/json":return b.json();case "text/plain":return b.text();default:return b}}).then(z,t).then(function(b){!1!==b&&g.fire();return b},function(b){g.fire();return b});l._fetchArgs=[b,f,q,[z,t],r];return l}var l=[];w.isFunc(t)&&l.push(t);var g={on:function(b){l.push(b);return g},off:function(b){l.splice(l.indexOf(b),1);return g},fire:w.raft(function(){w.execAll(l,arguments);return g}),
prop:function(h,f){var q=h,l=function(b,d){arguments.length&&b!==q&&(q=b,!1!==d&&g.fire());return q};if(f&&f.then){l.update=d;if(f._fetchArgs){var r=f._fetchArgs[3];f._fetchArgs[3]=[function(b){return l(r[0]?r[0](b):b)},r[1]];l.update=function(){b.apply(null,f._fetchArgs)}}f.then(l)}return l.toString=l},sync:function(b,d,g){var l=b,r=d;"string"==typeof b&&(l=function(d){return"e."===b.substr(0,2)?d[b.substr(2)]:d.target[b]});return function(b){var h=this!==window?this:null;h&&"string"==typeof d&&
(r=function(b,g){var l=h[d];h[d]=b;t&&b!==l&&!1!==g&&t()});r(l(b),g)}},get:function(d,f,g){return b("get",d,null,f,g)},"delete":function(d,f,g){return b("delete",d,null,f,g)},post:function(d,f,g,l){return b("post",d,f,g,l)},put:function(d,f,g,l){return b("put",d,f,g,l)},patch:function(d,f,g,l){return b("patch",d,f,g,l)}};return g}})(domvm);(function(u){function w(b,d,g){if("/"===d[0]){var h=d;d=null;var f,q;for(q in b)if(f=h.match(b[q].regexPath)){g=f.slice(1);d=q;break}null===d&&(d="_noMatch")}else h=t(b,d,g);return{name:d,route:b[d],params:g,path:h}}function t(b,d,g){var h=b[d];b=h.path;if(g&&-1!==b.indexOf(":")){g=g.slice();var f=!0;b=b.replace(/:([^\/]+)/g,function(b,d){var l=g.shift();if(h.params&&h.params[d]){if((""+l).match(h.params[d]))return l;f=!1}else return l});return f?b:f}return b}function d(b){for(var d in b){var g=b[d];
g.regexPath=new RegExp("^"+g.path.replace(/:([^\/]+)/g,function(b,d){var l=""+g.params[d];return"("+l.substring(1,l.lastIndexOf("/"))+")"})+"$")}}u.route=function(b,l){var g={href:function(b,d,f){var h=function(h){g["goto"](b,d,f);h.preventDefault()};h.path=t(u,b,d);return h},refresh:function(){g["goto"](window.location.pathname)},"goto":function(b,d,g){d=d||[];g=g||h;var l=w(u,b,d),t=l.path;b=l.name;d=l.params;if(!1===t)console.log("Could not find route");else{for(var l=null,x=0;x<q.length;x++)if(q[x].path===
t){l=x;break}null===l&&(q.splice(f+1,1E4),q.push({name:b,route:u[b],params:d,path:t}),l=q.length-1);var x=q[f],H=q[l];Array.prototype.slice.call(arguments);var B=!0;null!==f&&(B=(B=q[f].route.onexit)?B.apply(null,[{to:H}].concat(x?x.params:[])):!0);!1!==B&&!1!==q[l].route.onenter.apply(null,[{from:x}].concat(d))&&(history[g?"replaceState":"pushState"]([b,d],"title",t),f=l);h=!1}},current:function(){return h?w(u,window.location.pathname):q[f]}},h=!0,f=null,q=[],u=b(g,l);d(u);window.onpopstate=function(b){g["goto"].apply(null,
b.state.concat(!0))};return g}})(domvm);
