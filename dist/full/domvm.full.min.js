// https://github.com/leeoniya/domvm (3.x-dev, full build)
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.domvm=e()}(this,function(){"use strict";var n=1,e=2,t=3,r=4,l=5,o="undefined"!=typeof window,a=o?window:{},i=o?document:{},u=a.requestAnimationFrame,f={};function d(){}var s=Array.isArray;function c(n){return null!=n&&n.constructor===Object}function v(n){return"function"==typeof n}function y(n){for(var e=arguments,t=1;t<e.length;t++)for(var r in e[t])n[r]=e[t][r];return n}function p(n,e){for(var t=[],r=e;r<n.length;r++)t.push(n[r]);return t}function h(n,e){for(var t in n)if(n[t]!==e[t])return!1;return!0}function b(n,e){var t=n.length;if(e.length!==t)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function m(n){if(!u)return n;var e,t,r;function l(){e=0,n.apply(t,r)}return function(){t=this,r=arguments,e||(e=u(l))}}function g(n){return"o"===n[0]&&"n"===n[1]}function k(n){return"_"===n[0]}function _(n){return"style"===n}function w(n){n&&n.el&&n.el.offsetHeight}function x(n){return null!=n.node&&null!=n.node.el}function N(n,e){switch(e){case"value":case"checked":case"selected":return!0}return!1}function S(n){for(n=n||f;null==n.vm&&n.parent;)n=n.parent;return n.vm}function C(){}var A=C.prototype={constructor:C,type:null,vm:null,key:null,ref:null,data:null,hooks:null,ns:null,el:null,tag:null,attrs:null,body:null,flags:0,_class:null,_diff:null,_dead:!1,_lis:!1,idx:null,parent:null};function E(n){var t=new C;return t.type=e,t.body=n,t}var R=function(){return!1},O=d,I=d,L=d;function M(n,e){var t=I(n,function(n){t&&(null!=e.node&&e.redraw(),L(t))});return O(n)}function T(n,e){var t=I(n,function(n){t&&null!=e.node&&e.redraw()});return t}var V={},j=/\[(\w+)(?:=(\w+))?\]/g;var D=1,z=2,U=4,F=8;function H(e,t,r,l){var o=new C;o.type=n,o.flags=l||0,o.attrs=t||null;var a=function(n){var e,t,r,l,o=V[n];if(null==o)for(V[n]=o={tag:(e=n.match(/^[-\w]+/))?e[0]:"div",id:(t=n.match(/#([-\w]+)/))?t[1]:null,class:(r=n.match(/\.([-\w.]+)/))?r[1].replace(/\./g," "):null,attrs:null};l=j.exec(n);)null==o.attrs&&(o.attrs={}),o.attrs[l[1]]=l[2]||"";return o}(e);o.tag=a.tag;var i=null!=a.id,u=null!=a.class,f=null!=a.attrs;if(i||u||f){var d=o.attrs||{};if(i&&null==d.id&&(d.id=a.id),u&&(o._class=a.class,d.class=a.class+(null!=d.class?" "+d.class:"")),f)for(var s in a.attrs)null==d[s]&&(d[s]=a.attrs[s]);o.attrs=d}var c=o.attrs;return null!=c&&(null!=c._key&&(o.key=c._key),null!=c._ref&&(o.ref=c._ref),null!=c._hooks&&(o.hooks=c._hooks),null!=c._data&&(o.data=c._data),null!=c._flags&&(o.flags=c._flags),null==o.key&&(null!=o.ref?o.key=o.ref:null!=c.id?o.key=c.id:null!=c.name&&(o.key=c.name+("radio"===c.type||"checkbox"===c.type?c.value:"")))),null!=r&&(o.body=r),o}function G(n,t,o,a){if(n.type!==l&&n.type!==r){var i,u,f;n.parent=t,n.idx=o,n.vm=a,null!=n.ref&&(i=S(n),u=n.ref,f=n,function(n,e,t){for(var r;r=e.shift();)0===e.length?n[r]=t:n[r]=n=n[r]||{}}(i,["refs"].concat(u.split(".")),f));var d=n.hooks,c=a&&a.hooks;(d&&(d.willRemove||d.didRemove)||c&&(c.willUnmount||c.didUnmount))&&function(n){for(;n=n.parent;)n.flags|=D}(n),s(n.body)?function(n){for(var t=n.body,r=0;r<t.length;r++){var l=t[r];!1===l||null==l?t.splice(r--,1):s(l)?(a=l,i=r--,u=1,(o=t).splice.apply(o,[i,u].concat(a))):(null==l.type&&(t[r]=l=E(""+l)),l.type===e?null==l.body||""===l.body?t.splice(r--,1):r>0&&t[r-1].type===e?(t[r-1].body+=l.body,t.splice(r--,1)):G(l,n,r,null):G(l,n,r,null))}var o,a,i,u}(n):""===n.body?n.body=null:R(n.body)&&(n.body=M(n.body,S(n)))}}var P={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,order:!0,lineClamp:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function W(n,e){return isNaN(e)||P[n]?e:e+"px"}function Y(n,e){var t,r=(n.attrs||f).style,l=e?(e.attrs||f).style:null;if(null==r||("string"===(t=typeof r)||"number"===t))n.el.style.cssText=r;else{for(var o in r){var a=r[o];R(a)&&(r[o]=a=M(a,S(n))),(null==l||null!=a&&a!==l[o])&&(n.el.style[o]=W(o,a))}if(l)for(var i in l)null==r[i]&&(n.el.style[i]="")}}var q=[];function B(n,e,t,r,l){if(null!=n){var o=t.hooks[e];if(o){if("d"!==e[0]||"i"!==e[1]||"d"!==e[2])return o(t,r);l?w(t.parent)&&o(t,r):q.push([o,t,r])}}}function Z(n){var e;if(q.length)for(w(n.node);e=q.shift();)e[0](e[1],e[2])}function $(n){return n.nextSibling}function K(n,e,t){var r=e._node,l=r.vm;if(s(r.body))if((r.flags&D)===D)for(var o=0;o<r.body.length;o++)K(e,r.body[o].el);else J(r);delete e._node,n.removeChild(e),B(r.hooks,"didRemove",r,null,t),null!=l&&(B(l.hooks,"didUnmount",l,l.data,t),l.node=null)}function X(n,e){var t=e._node;if(!t._dead){var r,l,o,a,i=function n(e){var t=e.vm,r=null!=t&&B(t.hooks,"willUnmount",t,t.data),l=B(e.hooks,"willRemove",e);if((e.flags&D)===D&&s(e.body))for(var o=0;o<e.body.length;o++)n(e.body[o]);return r||l}(t);null!=i&&("object"==typeof(a=i)&&v(a.then))?(t._dead=!0,i.then((r=K,l=[n,e,!0],function(){return r.apply(o,l)}))):K(n,e)}}function J(n){for(var e=n.body,t=0;t<e.length;t++){var r=e[t];delete r.el._node,null!=r.vm&&(r.vm.node=null),s(r.body)&&J(r)}}function Q(n){var e=n.el;if(0==(n.flags&D))s(n.body)&&J(n),e.textContent=null;else{var t=e.firstChild;do{var r=$(t);X(e,t)}while(t=r)}}function nn(n,e,t){var r=e._node,l=null!=e.parentNode,o=e!==t&&l?null:r.vm;null!=o&&B(o.hooks,"willMount",o,o.data),B(r.hooks,l?"willReinsert":"willInsert",r),n.insertBefore(e,t),B(r.hooks,l?"didReinsert":"didInsert",r),null!=o&&B(o.hooks,"didMount",o,o.data)}function en(n,e,t){nn(n,e,t?$(t):null)}var tn={};var rn=d,ln=!1;function on(n,e,t){n[e]=t}function an(n,e,t,r,l){var o=n.apply(l,e.concat([t,r,l,l.data]));l.onevent(t,r,l,l.data,e),rn.call(null,t,r,l,l.data,e),!1===o&&(t.preventDefault(),t.stopPropagation())}function un(n){var e,t,r=function(n){for(;null==n._node;)n=n.parentNode;return n._node}(n.target),l=S(r),o=n.currentTarget._node.attrs["on"+n.type];if(s(o))an(e=o[0],t=o.slice(1),n,r,l);else for(var a in o)if(n.target.matches(a)){var i=o[a];s(i)?(e=i[0],t=i.slice(1)):(e=i,t=[]),an(e,t,n,r,l)}}function fn(n,e,t,r){if(t!==r){var l=n.el;null==t||v(t)?on(l,e,t):null==r&&on(l,e,un)}}function dn(n,e,t,r,l){var o=n.el;null!=n.ns?o.setAttribute(e,t):"class"===e?o.className=t:"id"===e||"boolean"==typeof t||r?o[e]=t:"."===e[0]?o[e.substr(1)]=t:o.setAttribute(e,t)}function sn(n,e,t){var r,l,o,a=n.attrs||f,i=e.attrs||f;if(a===i);else{for(var u in a){var d=a[u];if(null!=d){var s=N(n.tag,u),c=s?n.el[u]:i[u];R(d)&&(a[u]=d=M(d,S(n))),d===c||(_(u)?Y(n,e):k(u)||(g(u)?fn(n,u,d,c):dn(n,u,d,s)))}}for(var u in i)null==a[u]&&!k(u)&&(r=n,l=u,o=N(n.tag,u)||g(u),"."===l[0]&&(l=l.substr(1),o=!0),o?r.el[l]="":r.el.removeAttribute(l))}}function cn(n,e,t,l){return n.type===r&&(e=n.data,t=n.key,l=n.opts,n=n.view),new Cn(n,e,t,l)}function vn(n){for(var e=0;e<n.body.length;e++){var o=n.body[e],a=o.type;if(a<=t)nn(n.el,yn(o));else if(a===r){a=(i=cn(o.view,o.data,o.key,o.opts)._redraw(n,e,!1)).node.type,nn(n.el,yn(i.node))}else if(a===l){var i;(i=o.vm)._redraw(n,e),a=i.node.type,nn(n.el,i.node.el)}}}function yn(r,l){var o,a,u,d;return null==r.el&&(r.type===n?(r.el=l||(u=r.tag,null!=(d=r.ns)?i.createElementNS(d,u):i.createElement(u)),null!=r.attrs&&sn(r,f),(r.flags&F)===F&&r.body.body(r),s(r.body)?vn(r):null!=r.body&&(r.el.textContent=r.body)):r.type===e?r.el=l||(a=r.body,i.createTextNode(a)):r.type===t&&(r.el=l||(o=r.body,i.createComment(o)))),r.el._node=r,r.el}var pn=1,hn=2;function bn(n,e,t,r,l,o,a,i){return function(u,f,d,s,c,v){var y,p;if(null!=s[r]){if(null==(y=s[r]._node))return void(s[r]=n(s[r]));if(y.parent!==u)return p=n(s[r]),null!=y.vm?y.vm.unmount(!0):X(f,s[r]),void(s[r]=p)}if(s[l]==c)return hn;if(null==s[l].el)t(f,yn(s[l]),s[r]),s[l]=e(s[l],d);else if(s[l].el===s[r])s[l]=e(s[l],d),s[r]=n(s[r]);else{if(v||y!==s[a])return v&&null!=s[r]?function(n,e,t,r,l,o,a,i,u){if(i._lis)t(o,u[l].el,u[r]),u[l]=e(u[l],a);else{var f=function(n,e){var t,r=0,l=e.length-1;if(l<=2147483647)for(;r<=l;){if(e[t=r+l>>1]===n)return t;e[t]<n?r=t+1:l=t-1}else for(;r<=l;){if(e[t=Math.floor((r+l)/2)]===n)return t;e[t]<n?r=t+1:l=t-1}return r==e.length?null:r}(i.idx,u.tombs);i._lis=!0;var d=n(u[r]);t(o,u[r],null!=f?a[u.tombs[f]].el:f),null==f?u.tombs.push(i.idx):u.tombs.splice(f,0,i.idx),u[r]=d}}(n,e,t,r,l,f,d,y,s):pn;p=s[r],s[r]=n(p),i(f,p,s[o]),s[o]=p}}}var mn=bn($,function(n,e){return e[n.idx+1]},nn,"lftSib","lftNode","rgtSib","rgtNode",en),gn=bn(function(n){return n.previousSibling},function(n,e){return e[n.idx-1]},en,"rgtSib","rgtNode","lftSib","lftNode",nn);function kn(n,e,t,r){for(var l=[],o=l.slice.call(e.childNodes),a=0;a<o.length;a++){var i=o[a]._node;i.parent===n&&l.push(i.idx)}for(var u=function(n){var e,t,r=n.slice(),l=[];l.push(0);for(var o=0,a=n.length;o<a;++o){var i=l[l.length-1];if(n[i]<n[o])r[o]=i,l.push(o);else{for(e=0,t=l.length-1;e<t;){var u=(e+t)/2|0;n[l[u]]<n[o]?e=u+1:t=u}n[o]<n[l[e]]&&(e>0&&(r[o]=l[e-1]),l[e]=o)}}for(t=l[(e=l.length)-1];e-- >0;)l[e]=t,t=r[t];return l}(l).map(function(n){return l[n]}),f=0;f<u.length;f++)t[u[f]]._lis=!0;for(r.tombs=u;;){if(mn(n,e,t,r,null,!0)===hn)break}}function _n(n){return n.el._node.parent!==n.parent}function wn(n,e,t){return e[t]}function xn(n,e,t){for(;t<e.length;t++){var o=e[t];if(null!=o.vm){if(n.type===r&&o.vm.view===n.view&&o.vm.key===n.key||n.type===l&&o.vm===n.vm)return o}else if(!_n(o)&&n.tag===o.tag&&n.type===o.type&&n.key===o.key&&(n.flags&~D)==(o.flags&~D))return o}return null}function Nn(n,e,t){if(null==e._keys){if(e[t].key===n.key)return e[t];for(var r={},l=0;l<e.length;l++)r[e[l].key]=l;e._keys=r}return e[e._keys[n.key]]}function Sn(o,a){B(a.hooks,"willRecycle",a,o);var i=o.el=a.el,u=a.body,c=o.body;if(i._node=o,o.type!==e||c===u){null==o.attrs&&null==a.attrs||sn(o,a);var v=s(u),y=s(c),p=(o.flags&F)===F;v?y||p?function(e,o){var a=e.body,i=a.length,u=o.body,s=u.length,c=(e.flags&F)===F,v=(e.flags&z)===z,y=(e.flags&U)===U,p=!v&&e.type===n,h=!0,b=0===s?d:y?Nn:v||c?wn:xn;if(p&&0===i)return Q(o),void(c&&(e.body=[]));var m,g,k=0,_=!1,w=0;if(c)var N={key:null},S=Array(i);for(var C=0;C<i;C++){if(c){var A=!1,E=null;h&&(y&&(N.key=a.key(C)),m=b(N,u,w)),null!=m?(g=m.idx,!0===(E=a.diff(C,m))?((R=m).parent=e,R.idx=C,R._lis=!1):A=!0):A=!0,A&&(G(R=a.tpl(C),e,C),R._diff=null!=E?E:a.diff(C),null!=m&&Sn(R,m)),S[C]=R}else{var R=a[C],O=R.type;if(O<=t)(m=h&&b(R,u,w))&&(Sn(R,m),g=m.idx);else if(O===r){if(m=h&&b(R,u,w)){g=m.idx;var I=m.vm._update(R.data,e,C)}else var I=cn(R.view,R.data,R.key,R.opts)._redraw(e,C,!1);O=I.node.type}else if(O===l){var L=x(R.vm),I=R.vm._update(R.data,e,C,L);O=I.node.type}}if(null!=m&&(g===w?++w===s&&i>s&&(m=null,h=!1):_=!0,!y&&s>100&&_&&++k%10==0))for(;w<s&&_n(u[w]);)w++}c&&(e.body=S);p&&function(n,e){var t=e.body,r=n.el,l=n.body,o={lftNode:l[0],rgtNode:l[l.length-1],lftSib:(t[0]||f).el,rgtSib:(t[t.length-1]||f).el};n:for(;;){for(;;){var a=mn(n,r,l,o,null,!1);if(a===pn)break;if(a===hn)break n}for(;;){var i=gn(n,r,l,o,o.lftNode,!1);if(i===pn)break;if(i===hn)break n}kn(n,r,l,o);break}}(e,o)}(o,a):c!==u&&(null!=c?i.textContent=c:Q(a)):y?(Q(a),vn(o)):c!==u&&(null!=c&&null!=u?i.firstChild.nodeValue=c:i.textContent=c),B(a.hooks,"didRecycle",a,o)}else i.nodeValue=c}function Cn(n,e,t,r){var l=this;l.view=n,l.data=e,l.key=t,R(e)&&(l._stream=T(e,l)),r&&(l.opts=r,l.config(r));var o=c(n)?n:n.call(l,l,e,t,r);v(o)?l.render=o:(l.render=o.render,l.config(o)),l._redrawAsync=m(function(n){return l.redraw(!0)}),l._updateAsync=m(function(n){return l.update(n,!0)}),l.init&&l.init.call(l,l,l.data,l.key,r)}var An=Cn.prototype={constructor:Cn,_diff:null,init:null,view:null,key:null,data:null,state:null,api:null,opts:null,node:null,hooks:null,onevent:d,refs:null,render:null,mount:function(n,e){var t=this;e?(Q({el:n,flags:0}),t._redraw(null,null,!1),n.nodeName.toLowerCase()!==t.node.tag?(yn(t.node),nn(n.parentNode,t.node.el,n),n.parentNode.removeChild(n)):nn(n.parentNode,yn(t.node,n),n)):(t._redraw(null,null),n&&nn(n,t.node.el));n&&Z(t);return t},unmount:function(n){R(this._stream)&&L(this._stream);var e=this.node;X(e.el.parentNode,e.el),n||Z(this)},config:function(n){var e=this;n.init&&(e.init=n.init),n.diff&&(e.diff=n.diff),n.onevent&&(e.onevent=n.onevent),n.hooks&&(e.hooks=y(e.hooks||{},n.hooks)),n.onemit&&(e.onemit=y(e.onemit||{},n.onemit))},parent:function(){return S(this.node.parent)},root:function(){for(var n=this.node;n.parent;)n=n.parent;return n.vm},redraw:function(n){null==n&&(n=ln);return n?this._redraw(null,null,x(this)):this._redrawAsync(),this},update:function(n,e){null==e&&(e=ln);return e?this._update(n,null,null,x(this)):this._updateAsync(n),this},_update:function(n,e,t,r){var l=this;null!=n&&l.data!==n&&(B(l.hooks,"willUpdate",l,n),l.data=n,R(l._stream)&&L(l._stream),R(n)&&(l._stream=T(n,l)));return l._redraw(e,t,r)},_redraw:function(n,e,t){var r,l,o=null==n,a=this,i=a.node&&a.node.el&&a.node.el.parentNode,u=a.node;if(null!=a.diff&&(r=a._diff,a._diff=l=a.diff(a,a.data),null!=u)){var f=s(r)?b:h,d=r===l||f(r,l);if(d)return En(a,u,n,e)}i&&B(a.hooks,"willRedraw",a,a.data);var c=a.render.call(a,a,a.data,r,l);if(c===u)return En(a,u,n,e);a.refs=null,null!=a.key&&c.key!==a.key&&(c.key=a.key);a.node=c,n?(G(c,n,e,a),n.body[e]=c):u&&u.parent?(G(c,u.parent,u.idx,a),u.parent.body[u.idx]=c):G(c,null,null,a);if(!1!==t)if(u)if(u.tag!==c.tag||u.key!==c.key){u.vm=c.vm=null;var v=u.el.parentNode,y=$(u.el);X(v,u.el),nn(v,yn(c),y),u.el=c.el,c.vm=a}else Sn(c,u);else yn(c);i&&B(a.hooks,"didRedraw",a,a.data),o&&i&&Z(a);return a},_redrawAsync:null,_updateAsync:null};function En(n,e,t,r){return null!=t&&(t.body[r]=e,e.idx=r,e.parent=t,e._lis=!1),n}function Rn(n,e,t,r){var l,o;return null==t?c(e)?l=e:o=e:(l=e,o=t),H(n,l,o,r)}var On="http://www.w3.org/2000/svg";function In(n,e,t,r){this.view=n,this.data=e,this.key=t,this.opts=r}function Ln(n){this.vm=n}In.prototype={constructor:In,type:r,view:null,data:null,key:null,opts:null},Ln.prototype={constructor:Ln,type:l,vm:null};var Mn={config:function(n){var e,t;rn=n.onevent||rn,null!=n.syncRedraw&&(ln=n.syncRedraw),n.onemit&&(e=n.onemit,y(tn,e)),n.stream&&(t=n.stream,R=t.is,O=t.val,I=t.sub,L=t.unsub)},ViewModel:Cn,VNode:C,createView:cn,defineElement:Rn,defineSvgElement:function(n,e,t,r){var l=Rn(n,e,t,r);return l.ns=On,l},defineText:E,defineComment:function(n){var e=new C;return e.type=t,e.body=n,e},defineView:function(n,e,t,r){return new In(n,e,t,r)},injectView:function(n){return new Ln(n)},injectElement:function(e){var t=new C;return t.type=n,t.el=t.key=e,t},lazyList:function(n,e){var t=n.length,r={items:n,length:t,key:function(t){return e.key(n[t],t)},diff:function(t,r){var l=e.diff(n[t],t);if(null==r)return l;var o=r._diff;return(l===o||s(o)?b(l,o):h(l,o))||l},tpl:function(t){return e.tpl(n[t],t)},map:function(n){return e.tpl=n,r},body:function(n){for(var e=Array(t),l=0;l<t;l++){var o=r.tpl(l);o._diff=r.diff(l),e[l]=o,G(o,n,l)}n.body=e}};return r},FIXED_BODY:z,DEEP_REMOVE:D,KEYED_LIST:U,LAZY_LIST:F};function Tn(n){var e,t,r=arguments,l=r.length;if(l>1){var o=1;c(r[1])&&(t=r[1],o=2),e=l!==o+1||r[o]instanceof C||r[o]instanceof In||r[o]instanceof Ln?p(r,o):r[o]}return H(n,t,e)}function Vn(n){var e="";for(var t in n)null!=n[t]&&(e+=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+": "+W(t,n[t])+"; ");return e}function jn(n){return null==n?"":""+n}A.patch=function(n,e){!function(n,e,t){if(null!=e.type){if(null!=n.vm)return;G(e,n.parent,n.idx,null),n.parent.body[n.idx]=e,Sn(e,n),t&&w(e),Z(S(e))}else{var r=Object.create(n);r.attrs=y({},n.attrs);var l=y(n.attrs,e);if(null!=n._class){var o=l.class;l.class=null!=o&&""!==o?n._class+" "+o:n._class}sn(n,r),t&&w(n)}}(this,n,e)},An.emit=function(n){var e=this,t=e,r=p(arguments,1).concat(t,t.data);do{var l=e.onemit,o=l?l[n]:null;if(o){o.apply(e,r);break}}while(e=e.parent());tn[n]&&tn[n].apply(e,r)},An.onemit=null,An.body=function(){return function n(e,t){var r=e.body;if(s(r))for(var l=0;l<r.length;l++){var o=r[l];null!=o.vm?t.push(o.vm):n(o,t)}return t}(this.node,[])},Mn.defineElementSpread=Tn,Mn.defineSvgElementSpread=function(){var n=Tn.apply(null,arguments);return n.ns=On,n},An._stream=null;var Dn={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};function zn(n){n=jn(n);for(var e=0,t="";e<n.length;e++)switch(n[e]){case"&":t+="&amp;";break;case"<":t+="&lt;";break;case">":t+="&gt;";break;default:t+=n[e]}return t}function Un(n){n=jn(n);for(var e=0,t="";e<n.length;e++)t+='"'===n[e]?"&quot;":n[e];return t}function Fn(n,e){for(var t="",r=0;r<n.length;r++)t+=Gn(n[r],e);return t}var Hn=".innerHTML";function Gn(o,a){var i,u;switch(o.type){case r:i=cn(o.view,o.data,o.key,o.opts).html(a);break;case l:i=o.vm.html();break;case n:if(null!=o.el&&null==o.tag){i=o.el.outerHTML;break}var f="";f+="<"+o.tag;var d=o.attrs,c=null!=d;if(c){for(var v in d)if(!(g(v)||"."===v[0]||"_"===v[0]||!1===a&&N(o.tag,v))){var y=d[v];"style"!==v||null==y?!0===y?f+=" "+zn(v)+'=""':!1===y||null!=y&&(f+=" "+zn(v)+'="'+Un(y)+'"'):u="object"==typeof y?Vn(y):y}null!=u&&(f+=' style="'+Un(u.trim())+'"')}if(null==o.body&&null!=o.ns&&"svg"!==o.tag)return f+"/>";f+=">",Dn[o.tag]||(c&&null!=d[Hn]?f+=d[Hn]:s(o.body)?f+=Fn(o.body,a):(o.flags&F)===F?(o.body.body(o),f+=Fn(o.body,a)):f+=zn(o.body),f+="</"+o.tag+">"),i=f;break;case e:i=zn(o.body);break;case t:i="\x3c!--"+zn(o.body)+"--\x3e"}return i}return An.attach=function(n){return null==this.node&&this._redraw(null,null,!1),function n(e,t){e.el=t,t._node=e;var o=e.attrs;for(var a in o){var i=o[a],u=N(e.tag,a);_(a)||k(a)||(g(a)?fn(e,a,i):null!=i&&u&&dn(e,a,i,u))}if((e.flags&F)===F&&e.body.body(e),s(e.body)&&e.body.length>0){var f=t.firstChild,d=0,c=e.body[d];do{c.type===r?c=cn(c.view,c.data,c.key,c.opts)._redraw(e,d,!1).node:c.type===l&&(c=c.node||c._redraw(e,d,!1).node),n(c,f)}while((f=f.nextSibling)&&(c=e.body[++d]))}}(this.node,n),this},An.html=function(n){return null==this.node&&this._redraw(null,null,!1),Gn(this.node,n)},A.html=function(n){return Gn(this,n)},Mn});